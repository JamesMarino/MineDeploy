{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Parameters": {
    "ServerName": {
      "Type": "String",
      "Description": "Server Name"
    },
    "ClusterName": {
      "Type": "String",
      "Description": "Cluster Name"
    },
    "BackupBucketName": {
      "Type": "String",
      "Description": "Backup Bucket Name"
    },
    "LoadBalancerName": {
      "Type": "String",
      "Description": "Load Balancer Id"
    }
  },
  "Resources": {
    "MineDeployDashboard": {
      "Type": "AWS::CloudWatch::Dashboard",
      "Properties": {
        "DashboardBody": {
          "Fn::Join": [
            "",
            [
              "{\"widgets\":[{\"type\":\"metric\",\"x\":0,\"y\":0,\"width\":12,\"height\":6,\"properties\":{\"metrics\":[[\"AWS/ECS\",\"CPUUtilization\",\"ClusterName\",\"",
              {
                "Ref": "ClusterName"
              },
              "\",{\"id\":\"m1\"}],[\".\",\"MemoryUtilization\",\".\",\".\"]],\"view\":\"timeSeries\",\"stacked\":false,\"region\":\"",
              {
                "Ref": "AWS::Region"
              },
              "\",\"title\":\"Cluster Load\",\"period\":300}},{\"type\":\"metric\",\"x\":12,\"y\":0,\"width\":12,\"height\":6,\"properties\":{\"view\":\"timeSeries\",\"stacked\":false,\"region\":\"",
              {
                "Ref": "AWS::Region"
              },
              "\",\"start\":\"-P3D\",\"end\":\"P0D\",\"metrics\":[[\"AWS/S3\",\"BucketSizeBytes\",\"StorageType\",\"StandardStorage\",\"BucketName\",\"",
              {
                "Ref": "BackupBucketName"
              },
              "\",{\"period\":86400}]],\"title\":\"Backup Bucket Size\"}},{\"type\":\"metric\",\"x\":0,\"y\":6,\"width\":12,\"height\":6,\"properties\":{\"view\":\"timeSeries\",\"stacked\":false,\"region\":\"",
              {
                "Ref": "AWS::Region"
              },
              "\",\"start\":\"-P3D\",\"end\":\"P0D\",\"metrics\":[[\"AWS/EBS\",\"VolumeWriteBytes\",\"VolumeId\",\"vol-123456789\"],[\".\",\"VolumeReadBytes\",\".\",\".\"]],\"title\":\"Cluster Volume IO\"}},{\"type\":\"metric\",\"x\":12,\"y\":6,\"width\":12,\"height\":6,\"properties\":{\"view\":\"timeSeries\",\"stacked\":false,\"region\":\"",
              {
                "Ref": "AWS::Region"
              },
              "\",\"start\":\"-P3D\",\"end\":\"P0D\",\"metrics\":[[\"AWS/NetworkELB\",\"ProcessedBytes\",\"LoadBalancer\",\"",
              {
                "Ref": "LoadBalancerName"
              },
              "\"]],\"title\":\"Load Balancer Processed Bytes\"}}]}"
            ]
          ]
        },
        "DashboardName": "MineDeployDashboard"
      }
    }
  }
}
